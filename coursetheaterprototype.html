<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

	<title>Course Theater Wireframe</title>
    <link href='fliptstyle.css' rel='stylesheet' type='text/css'/>
    <link href='http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.17/themes/base/jquery-ui.css' rel='stylesheet' type='text/css'/>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script> 
</head>
<body>
    <div id="container">
        <div id="navigation">
            <div class="col-full">
                <div id="logo">
                </div>
                <ul>
                    <li><a href="">Blog</a></li>
                    <li><a href="">Answers</a></li>
                    <li><a href="" class="thisPage">Course</a></li>
                    <li><a href="">Profile</a></li>
                </ul>
            </div>
        </div>
        <div id="content" class="col-full">
            <div id="announce">
                <span>
                        Looks like that's a new question. Go ahead and fill in the form with the question and some explanation and we'll get it answered in a jiffy. Make sure to subscribe to be notified when it's answered!
                </span>
            </div>
            <div id="main" class="fullwidth">
                <div class="post">
                    <div id="vidContainer">
                        <div id="vid">
                            <iframe id="courseVid" width="710" height="400" src="http://www.youtube.com/embed/qP1Z3M9G1j0" frameborder="0" allowfullscreen></iframe>
                        </div>
                        <div id="vidList">
                            <h3 id="vidListHeader"> Clip Module </h3>
                            <ul>
                                
                            </ul>
                        </div>
                    </div>
                </div>
                <div id="vidNav">
                    <ul>
                        <li id="prev">Previous</li>
                        <li id="next">Next</li>
                    </ul>
                </div>
                    <div id="questionBar">
                        <div class="ui-widget">
                       <form id="questionAsk" action="submitQuestion" method="get" accept-charset="utf-8">
                           <p><input id="tags" type="text" onfocus="if(this.value == 'Have a question? Ask it here!'){ this.value = ''; }" onblur="if(this.value ==''){ this.value = 'Have a question? Ask it here!';}" value="Have a question? Ask it here!" /><input id="questionSubmit" type="submit" name="q" value="Ask Away" /></p>
                       </form>
                        </div>
                    </div>
                <div id="info" class="post">
                    <div id="queryResults">
                    <div class="results">
                        <ul id="queryResultsUl">
                        </ul>
                    </div>
                    </div>
                    <div id="newQuestion">
                        <form action="newQuestionSubmit" method="post" accept-charset="utf-8">
                            <input type="text" id="questionTitle" name="questionTitle" value="" />
                            <div>
                                <textarea id="questionBody" name="questionBody" rows="8" cols="40"></textarea>
                            
                         </div>
                        <p><input id="newQuestionSubmit" type="submit" value="Post Question" />

                        <input id="newQuestionCancel" type="button" value="Cancel" />
                        <label>Subscribe to this question?</label>
                        <input id="newQuestionSubscribe" type="checkbox" name="subscribe" value="subscribe" /></p>
                        </form>
                    </div>
                </div>
                
            </div>
        </div>
        <div id="footer">
            <div id="main" class="fullwidth">
            </div>
        </div>
    </div>
</body>
    <script>
$(document).ready(function(){
        function test1() {
            alert('test');
        }
        var instructions = "Looks like that question is new. Go ahead and enter the details of your question in this box and check the box below to be notified when an answer is posted!"
        function showNewQuestion(){
            $("#questionBar").slideUp();
            $("#newQuestion").show(200);
            $("#queryResults").slideUp();
            var newQuestionTitle = $("#tags").attr('value');
            $("#questionTitle").attr('value', newQuestionTitle);

        }
        function hideNewQuestion() {
            $("#newQuestion").slideUp();
            $("#questionBar").slideDown();
        }

        function showResults(){
            if( $("#queryResults").css('display') == 'none'){
                $("#queryResults").fadeIn();
                }else {
                //$("#queryResults").fadeOut();
            }
        }

        function postNewQuestion(title){
            $("#newQuestion").fadeOut();
            $("").replaceAll("#queryResults ul li");
            $("#queryResultsUl").append( '<li id="questionSuccess" class="resultTitle">' + title + '</li><ul><li class="resultExcerpt"> <span class="noAnswer">No Answer...yet.</span></li></ul>');
            showResults();
            $("#tags").attr('value', "")
            $("#questionBar").slideDown();
            $("#queryResults ul li").delay(1200).fadeOut('slow');
        }
        

        var pos = 0;
        var playlistJSON = [{ "title": "Love King", "src": "http://www.youtube.com/embed/AGcQgUnxY14" }, {"title": "Keep on Lovin Me", "src": "http://www.youtube.com/embed/qP1Z3M9G1j0" }, { "title": "Screams of Passion", "src": "http://www.youtube.com/embed/D6zduBiRZw8"}];
        var vesultsJSON = [{ "resultTitle": "What time is Workaholics on?", "resultExcerpt": "Dunno, ask Anthony."}, {"resultTitle": "Is Futurama better than the Simpsons?", "resultExcerpt": "I keep on hearing that it is, but I'm not so sure..."}]
        var filterJSON = [{ "resultTitle": "What is the best type of filter to use on a bassline?", "resultExcerpt": "I tend to use a low-pass filter, but it really depends", "answeredBy": "anthonyarroyo"}, { "resultTitle": "How can I MIDI map the filter type?", "resultExcerpt": "You actually can't map filter type to a button. You have to map it to a knob, so that you can scroll through them.", "answeredBy": "AfroDJMac"}]
        var deviceRackJSON = [{ "resultTitle": "Is there a maximum number of chains in a device rack?", "resultExcerpt": "I don't think that there is a hard limit, but at some point it becomes unwiedly. I usually try to keep it under at least 128, since after that you can't effectively use the chain selector.", "answeredBy": "anthonyarroyo"}, { "resultTitle": "How can you assign more than 8 macros?", "resultExcerpt": "You can only assign 8 macros, after that you have to use MIDI controllers.", "answeredBy": "AfroDJMac"}]
        var resultsDictJSON = { "Filters": filterJSON, "Device Racks": deviceRackJSON }
        var vidList = [];
        var results = [];
        var deactivateVidNav = function(pos){
            if (pos == playlistJSON.length - 1){
                $("#next").addClass("deactivated");
                } else {
                $("#next").removeClass("deactivated");
            }
            if (pos == 0){
                $("#prev").addClass("deactivated");
                } else {
                $("#prev").removeClass("deactivated");
            }
        };

        function resultsList(key) {
            $.each(resultsDictJSON[key], function(i, item) {
                results.push('<li id="' + i + '" class="resultTitle">' + item.resultTitle + '</li><ul><li class="resultExcerpt">' + item.resultExcerpt + '<span class="answeredBy">' + item.answeredBy +'</span></li></ul>')
            });
            $("#queryResultsUl").append( results.join( '' ) );
            results = [];
        }

        // Prep page at load
        $("#courseVid").attr('src', playlistJSON[pos].src);
        deactivateVidNav(pos);
        $("#newQuestion").css('display', 'none');
        $("textarea").val(instructions);
        $("textarea").css('color', 'grey');
        // Autocomplete 
    $(function() {
        var tags = [
            "Clips",
            "Devices",
            "Device Racks",
            "Sampler",
            "Filters"
        ];
        $( "#tags" ).autocomplete({
            source: tags
        });
    });
        // Slide down results
        // Slide down announcements
        $("#logo").click(function(){
            if( $("#announce").css('display') == 'none'){
            $("#announce").slideDown();
            } else {
            $("#announce").fadeOut();
        }
        });
        // Check if announcement has been seen already. Announcement can come to page as JSON and include an expiration date. Set a cookie for the last announcement, so that the script can see if it has already been seen.

        // Generate clickable VidList from JSON
        $.each(playlistJSON, function(i, item) {
            vidList.push('<li id="' + i + '" class="vidListItem">' + item.title + '</li>');
        });
        $("#vidList ul").append( vidList.join( '' ) );
        $("#" + pos).addClass("isPlaying");
        // click to navigate to video
        $(".vidListItem").click(function(){
            pos = this.id;
            $("#courseVid").attr('src', playlistJSON[pos].src);
            $(".isPlaying").removeClass("isPlaying");
            $(this).addClass("isPlaying");
            deactivateVidNav(pos);
        });
        // List of results from JSON to display in #queryResults
        // Previous and Next buttons
        $("#prev").click(function() {
            if (pos != 0){
            pos --;
            $(".isPlaying").removeClass("isPlaying");
            $("#" + pos).addClass("isPlaying");
            $("#courseVid").attr('src', playlistJSON[pos].src);
            } else{
        }
            deactivateVidNav(pos);
        });

        $("#next").click(function() {
            if (pos < playlistJSON.length - 1){
            pos ++;
            $(".isPlaying").removeClass("isPlaying");
            $("#" + pos).addClass("isPlaying");
            $("#courseVid").attr('src', playlistJSON[pos].src);
            } else {
        }
            deactivateVidNav(pos);
        });
        // Intercept submission, fadeIn results in INFO
        // TODO There is a bug on repeated question submission. My guess is that it is related to global v local variables
        $("#questionAsk").submit(function(){
            //$("#queryResults").fadeOut('fast');
            $("").replaceAll("#queryResults ul li");
            var submission = $("#tags").attr('value');
            if (submission != "Have a question? Ask it here!") {
                if (submission in resultsDictJSON){
                resultsList(submission);
                showResults();
                return false;
                } else {
                showNewQuestion();
                return false;
                }
            } else {
            alert("You don't have any questions?");
            return false;
        }
        });
        // Hide newQuestion on cancel
        $("#newQuestionCancel").click(function(){
            hideNewQuestion();
        });
        // Post a new question
        $("#newQuestionSubmit").click(function(){
            var title = $("#questionTitle").attr('value')
            postNewQuestion(title);
            return false;
        });
        $("textarea").focus(function(){
            if ( $("textarea").val() == instructions ){
                $("textarea").val("");
                $("textarea").css('color', 'black');
            }
            });
        $("textarea").blur(function(){
            if ( $("textarea").val() == "" ){
                $("textarea").css('color', 'grey');
                $("textarea").val(instructions);
            }
            });

});
    </script>

</html>
